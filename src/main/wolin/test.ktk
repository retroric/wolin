package pl.qus.wolin

var interruptRoutineVector: uword^0x314 // this is C64 raster interrupt vector
var cia1InerruptCtrlReg: ubyte^0xDC0D
var vicScreenCtrlReg1: ubyte^0xD011
var vicRasterLine: ubyte^0xD012
var vicInterruptStatusReg: ubyte^0xd019
var vicInterruptCtrlReg: ubyte^0xd01a
var vicBorder: ubyte^53280
var i: ubyte
var maskInterrupts: bool^CPU.I

fun clearScreen^0xe544()

interrupt fun blueBg() {
    interruptRoutineVector = whiteBg
    vicRasterLine = 140
    vicBorder = 6
    vicInterruptStatusReg = 0xff
    return@0xea31
}

interrupt fun whiteBg() {

}

// adnotacja interrupt - zabrania używania argumentów, wartości zwrotnych i zmiennych lokalnych


fun main() {
    clearScreen()
    maskInterrupts = true
    cia1InerruptCtrlReg = 0x7f
    vicInterruptCtrlReg := 1
    //vicScreenCtrlReg1 = vicScreenCtrlReg1 and 0x7f
    vicRasterLine = 140
    interruptRoutineVector = blueBg
    maskInterrupts = false

    do {} while (true)
}
